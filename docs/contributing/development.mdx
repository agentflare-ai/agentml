---
title: "Development Guide"
description: "Set up your development environment for AgentML"
---

# Development Guide

Set up your local development environment to contribute to AgentML and agentmlx.

## Prerequisites

### For AgentML (Specification & Docs)
- Node.js 18+ or 20+
- npm or pnpm
- Git
- Code editor (VS Code recommended)

### For agentmlx (Runtime)
- Go 1.21+
- Git
- Make (optional, for build scripts)
- Code editor with Go support

## Clone Repositories

### AgentML Specification

```bash
git clone https://github.com/agentflare-ai/agentml.git
cd agentml
```

### agentmlx Runtime

```bash
git clone https://github.com/agentflare-ai/agentmlx.git
cd agentmlx
```

## Project Structure

### agentml (Specification)

```
agentml/
├── docs/                  # Documentation (MDX)
│   ├── getting-started/
│   ├── concepts/
│   ├── architecture/
│   ├── extensions/
│   ├── deployment/
│   ├── best-practices/
│   └── contributing/
├── examples/              # Example agents
│   ├── chatbot.aml
│   ├── workflow.aml
│   └── rag-agent.aml
├── schemas/               # JSON schemas
└── package.json
```

### agentmlx (Runtime)

```
agentmlx/
├── cmd/
│   └── agentmlx/         # CLI entry point
│       └── main.go
├── pkg/
│   ├── scxml/            # SCXML interpreter
│   ├── namespaces/       # Built-in namespaces
│   │   ├── gemini/       # Gemini extension
│   │   ├── ollama/       # Ollama extension
│   │   ├── memory/       # Memory extension
│   │   └── stdin/        # Stdin/stdout extension
│   ├── parser/           # XML parser
│   ├── datamodel/        # ECMAScript datamodel
│   └── ioprocessor/      # I/O processors (HTTP, WebSocket)
├── tests/
│   ├── unit/             # Unit tests
│   ├── integration/      # Integration tests
│   └── conformance/      # W3C SCXML conformance tests
├── examples/             # Example agents
└── go.mod
```

## Development Setup

### AgentML Documentation

Install dependencies:

```bash
cd agentml
npm install
```

Start documentation server:

```bash
npm run docs:dev
```

Visit `http://localhost:3000` to view docs.

### agentmlx Runtime

Install Go dependencies:

```bash
cd agentmlx
go mod download
```

Build the runtime:

```bash
go build -o agentmlx cmd/agentmlx/main.go
```

Run an agent:

```bash
./agentmlx run examples/chatbot.aml
```

## Development Workflow

### Runtime Development

**Watch and rebuild:**

```bash
# Terminal 1: Watch for changes
go run cmd/agentmlx/main.go run examples/test.aml

# Terminal 2: Make changes to source
vim pkg/scxml/interpreter.go
```

**Run tests in watch mode:**

```bash
# Install gotestsum
go install gotest.tools/gotestsum@latest

# Watch tests
gotestsum --watch -- -v ./...
```

**Hot reload for development:**

```bash
# Install air
go install github.com/cosmtrek/air@latest

# Run with hot reload
air
```

### Adding a New Namespace

1. **Create namespace package:**

```bash
mkdir -p pkg/namespaces/myextension
```

2. **Implement actions:**

```go
// pkg/namespaces/myextension/extension.go
package myextension

import "github.com/agentflare-ai/agentmlx/pkg/scxml"

type MyAction struct {
    Param    string `xml:"param,attr"`
    Location string `xml:"location,attr"`
}

func (a *MyAction) Execute(ctx *scxml.Context) error {
    // Your implementation
    result := process(a.Param)

    ctx.SetVariable(a.Location, result)
    ctx.RaiseEvent("myext.complete", map[string]interface{}{
        "result": result,
    })

    return nil
}

func Register() {
    scxml.RegisterNamespace("github.com/example/myextension", map[string]interface{}{
        "myaction": &MyAction{},
    })
}
```

3. **Add tests:**

```go
// pkg/namespaces/myextension/extension_test.go
package myextension

import (
    "testing"
    "github.com/stretchr/testify/assert"
    "github.com/agentflare-ai/agentmlx/pkg/scxml"
)

func TestMyAction(t *testing.T) {
    ctx := scxml.NewTestContext()

    action := &MyAction{
        Param:    "test",
        Location: "result",
    }

    err := action.Execute(ctx)
    assert.NoError(t, err)

    result := ctx.GetVariable("result")
    assert.NotNil(t, result)
}
```

4. **Register in runtime:**

```go
// cmd/agentmlx/main.go
import "github.com/agentflare-ai/agentmlx/pkg/namespaces/myextension"

func init() {
    myextension.Register()
}
```

## Testing

### Unit Tests

```bash
# Run all tests
go test ./...

# Run specific package
go test ./pkg/scxml/...

# Run with coverage
go test -cover ./...

# Generate coverage report
go test -coverprofile=coverage.out ./...
go tool cover -html=coverage.out
```

### Integration Tests

```bash
# Run integration tests
go test ./tests/integration/...

# Run specific test
go test -run TestChatbotAgent ./tests/integration/...
```

### SCXML Conformance Tests

```bash
# Run W3C conformance tests
go test ./tests/conformance/...

# Run specific conformance test
go test -run TestDatamodel ./tests/conformance/...

# View conformance report
go test -v ./tests/conformance/... | grep -E "PASS|FAIL"
```

### Validate Example Agents

```bash
# Validate all examples
for agent in examples/*.aml; do
    ./agentmlx validate "$agent"
done

# Run all examples
for agent in examples/*.aml; do
    echo "Testing $agent"
    ./agentmlx run "$agent" --event '{"name": "test"}'
done
```

## Debugging

### VS Code Launch Configuration

**.vscode/launch.json:**

```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Debug agentmlx",
      "type": "go",
      "request": "launch",
      "mode": "debug",
      "program": "${workspaceFolder}/cmd/agentmlx",
      "args": ["run", "examples/chatbot.aml"],
      "env": {
        "GEMINI_API_KEY": "your-api-key"
      }
    },
    {
      "name": "Debug Tests",
      "type": "go",
      "request": "launch",
      "mode": "test",
      "program": "${workspaceFolder}/pkg/scxml",
      "args": ["-test.v", "-test.run", "TestStateMachine"]
    }
  ]
}
```

### Delve Debugger

```bash
# Install delve
go install github.com/go-delve/delve/cmd/dlv@latest

# Debug with delve
dlv debug cmd/agentmlx/main.go -- run examples/chatbot.aml

# Set breakpoint
(dlv) break pkg/scxml/interpreter.go:123
(dlv) continue
```

### Debug Logging

Enable debug output:

```bash
# Set log level
export AGENTML_LOG_LEVEL=debug
./agentmlx run agent.aml

# Verbose output
./agentmlx run agent.aml --verbose
```

## Benchmarking

Profile runtime performance:

```bash
# CPU profiling
go test -cpuprofile=cpu.prof -bench=. ./pkg/scxml/
go tool pprof cpu.prof

# Memory profiling
go test -memprofile=mem.prof -bench=. ./pkg/scxml/
go tool pprof mem.prof

# Benchmark specific functions
go test -bench=BenchmarkInterpreter -benchmem ./pkg/scxml/
```

## Code Quality

### Linting

```bash
# Install golangci-lint
go install github.com/golangci/golangci-lint/cmd/golangci-lint@latest

# Run linter
golangci-lint run

# Run with auto-fix
golangci-lint run --fix
```

### Formatting

```bash
# Format all code
go fmt ./...

# Format imports
go install golang.org/x/tools/cmd/goimports@latest
goimports -w .
```

### Static Analysis

```bash
# Vet code
go vet ./...

# Check for inefficient assignments
go install github.com/gordonklaus/ineffassign@latest
ineffassign ./...

# Check for common mistakes
go install honnef.co/go/tools/cmd/staticcheck@latest
staticcheck ./...
```

## Documentation Development

### Local Preview

```bash
cd agentml
npm run docs:dev
```

### Build Documentation

```bash
npm run docs:build
```

### Add New Documentation

Create MDX file:

```mdx
---
title: "Your Title"
description: "Brief description"
---

# Your Title

Content goes here...
```

Update navigation in `docs-site/nav.ts`.

## Release Process

### Version Bump

```bash
# Update version
vim VERSION  # Update version number

# Tag release
git tag v0.2.0
git push origin v0.2.0
```

### Build Release Binaries

```bash
# Build for all platforms
make release

# Or manually
GOOS=linux GOARCH=amd64 go build -o agentmlx-linux-amd64 cmd/agentmlx/main.go
GOOS=darwin GOARCH=arm64 go build -o agentmlx-darwin-arm64 cmd/agentmlx/main.go
GOOS=windows GOARCH=amd64 go build -o agentmlx-windows-amd64.exe cmd/agentmlx/main.go
```

### Update Install Script

Update version in `install.sh`:

```bash
VERSION="0.2.0"
```

## Continuous Integration

### GitHub Actions

CI runs automatically on:
- Pull requests
- Pushes to main branch
- Release tags

**Workflows:**
- `.github/workflows/test.yml` - Run tests
- `.github/workflows/conformance.yml` - SCXML conformance
- `.github/workflows/lint.yml` - Code quality
- `.github/workflows/release.yml` - Build releases

### Local CI Simulation

```bash
# Install act
brew install act

# Run CI locally
act push
act pull_request
```

## Best Practices

1. **Write tests first**: Follow TDD for new features
2. **Keep commits atomic**: One logical change per commit
3. **Update documentation**: Document as you code
4. **Follow Go conventions**: Use `gofmt`, follow Effective Go
5. **Check conformance**: Ensure SCXML compliance
6. **Profile performance**: Benchmark critical paths
7. **Handle errors**: Always check and handle errors properly
8. **Log appropriately**: Use structured logging
9. **Review before commit**: Self-review your changes
10. **Be responsive**: Address review comments promptly

## Getting Help

- **Documentation**: Read the full [AgentML docs](/getting-started/overview)
- **Issues**: Search [existing issues](https://github.com/agentflare-ai/agentml/issues)
- **Discussions**: Ask in [GitHub Discussions](https://github.com/agentflare-ai/agentml/discussions)
- **Discord**: Join our community (coming soon)

## Resources

- [W3C SCXML Specification](https://www.w3.org/TR/scxml/)
- [Effective Go](https://golang.org/doc/effective_go.html)
- [Go Testing](https://golang.org/pkg/testing/)
- [Delve Debugger](https://github.com/go-delve/delve)

Happy coding! Let's build the future of AI agents together.
